{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '44402631-bf7d189f653a3e22d2fd50e44';\nconst imageType = 'photo';\nconst imgOrientation = 'horizontal';\nconst safeSearch = 'true';\nconst perPage = 15;\n\nexport default class PixabayApi {\n    constructor() {\n        this.page = 1;\n        this.searchQuery = '';\n    }\n\n    async getImages() {\n        const { data } = await axios.get(`${BASE_URL}?key=${API_KEY}&q=${this.searchQuery}&image_type=${imageType}&orientation=${imgOrientation}&safesearch=${safeSearch}&per_page=${perPage}&page=${this.page}`);\n        this.incrementPage();\n        return data;\n    }\n\n    resetPage() {\n        this.page = 1;\n    }\n\n    incrementPage() {\n        this.page += 1;\n    }\n}\n\nexport { perPage };\n\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst refs = {\n    imageWrapper: document.querySelector('.js-imageWrapper'),\n};\n\nconst lightbox = new SimpleLightbox('.img-card a');\n\nfunction createMarkup({webformatURL, largeImageURL, tags, likes, views, comments, downloads}) {\n    return `<div class=\"img-card\">\n            <a href=\"${largeImageURL}\"><img src=\"${webformatURL}\" alt=\"${tags}\"></a> \n            <div class=\"text-wrapper\">\n            <p class=\"text\">Likes<span class=\"wrapper\">${likes}</span></p>\n            <p class=\"text\">Views<span class=\"wrapper\">${views}</span></p>\n            <p class=\"text\">Comments<span class=\"wrapper\">${comments}</span></p>\n            <p class=\"text\">Downloads<span class=\"wrapper\">${downloads}</span></p></div>\n            </div>`\n};\n\nfunction updateImgList(markup) {\n    refs.imageWrapper.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n};\n\nfunction clearImageList() {\n    refs.imageWrapper.innerHTML = '';\n};\n\nclass LoadMoreBtn {\n    static classes = {\n        hidden: 'hidden',\n        loader: 'loader'\n    }\n    constructor({selector, isHidden = false}) {\n        this.button = this.getButton(selector);\n        isHidden && this.hide();\n    }\n\n    getButton(selector) {\n        return document.querySelector(selector);\n    }\n\n    hide() {\n        this.button.classList.add(LoadMoreBtn.classes.hidden);\n    }\n\n    show() {\n        this.button.classList.remove(LoadMoreBtn.classes.hidden);\n    }\n\n    disable() {\n        this.button.disabled = true; \n        this.button.textContent = ''; \n        this.button.classList.add(LoadMoreBtn.classes.loader);\n    }\n\n    enable() {\n        this.button.disabled = false;\n        this.button.textContent = 'Load more'\n        this.button.classList.remove(LoadMoreBtn.classes.loader);\n    }\n}\n\nfunction smoothScroll() {\n    const { height: cardHeight } = refs.imageWrapper.firstElementChild.getBoundingClientRect();\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n}\n\nexport { createMarkup, updateImgList, clearImageList,  LoadMoreBtn, smoothScroll};","import PixabayApi, { perPage } from './js/pixabay-api.js'\nimport { createMarkup, updateImgList, clearImageList, LoadMoreBtn, smoothScroll } from './js/render-functions.js';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst refs = {\n    form: document.querySelector('.js-form')\n};\n\nconst pixabayApi = new PixabayApi();\nconst loadMoreBtn = new LoadMoreBtn({\n    selector: '.loadMore',\n    isHidden: true\n});\n\nrefs.form.addEventListener('submit', onSearch);\nloadMoreBtn.button.addEventListener('click', (e) => fetchImages(e));\n\nfunction onSearch(event) {\n    event.preventDefault();\n    const form = event.currentTarget;\n    const value = form.elements.image.value.trim();\n  \n    if (value === '') \n        return iziToast.warning({\n        position: 'topRight',\n        title: 'Caution',\n        message: 'You forgot important data',\n    })\n    else {\n        pixabayApi.searchQuery = value;\n        pixabayApi.resetPage();\n        loadMoreBtn.show();\n        clearImageList();\n        fetchImages()\n        .finally(() => { \n         form.reset();\n        });\n    }\n};\n\nasync function fetchImages(e) {\n    loadMoreBtn.disable();\n    try {\n        const markup = await getImagesMarkup(); \n        if (markup) updateImgList(markup);\n        if (e && e.target === loadMoreBtn.button) smoothScroll()\n    } catch(err) {\n        onError(err);\n    }\n    loadMoreBtn.enable();  \n}\n\nasync function getImagesMarkup() {\n    try {\n        const {hits, totalHits}  = await pixabayApi.getImages();\n        if (hits.length === 0) {\n            onError();   \n        } \n        else if (hits.length < perPage || pixabayApi.page * perPage > totalHits) { \n            loadMoreBtn.hide();\n            iziToast.warning({\n                position: 'topRight',\n                title: 'Caution',\n                message: 'We are sorry, but you have reached the end of search results',\n            })\n        }\n        return hits.reduce((markup, image) => markup + createMarkup(image), '');\n    } catch (err) {\n        onError(err);\n      }\n}\n\nfunction onError() {\n    loadMoreBtn.hide();\n    iziToast.error({\n        position: 'topRight',\n        title: 'Error',\n        message:'Sorry, there are no images matching your search query. Please try again!'});\n    clearImageList()\n};\n"],"names":["BASE_URL","API_KEY","imageType","imgOrientation","safeSearch","perPage","PixabayApi","data","axios","refs","lightbox","SimpleLightbox","createMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","updateImgList","markup","clearImageList","_LoadMoreBtn","selector","isHidden","__publicField","LoadMoreBtn","smoothScroll","cardHeight","pixabayApi","loadMoreBtn","onSearch","e","fetchImages","event","form","value","iziToast","getImagesMarkup","onError","hits","totalHits","image"],"mappings":"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"}